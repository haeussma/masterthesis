
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Scenario C:SLAC characterization &#8212; From raw data to kinetic parameters: an EnzymeML-based workflow for reproducible enzyme kinetics</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Scenario D:Time-dependent enzyme inactivation" href="enzyme_inactivation.html" />
    <link rel="prev" title="Scenario B:α-glucosidase inhibition by fucoidan" href="glycosidase_inhibition.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">From raw data to kinetic parameters: an EnzymeML-based workflow for reproducible enzyme kinetics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../welcome.html">
                    Welcome to my master thesis
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../declaration.html">
   Declaration of authorship
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../acknowledgements.html">
   Acknowledgements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../abstract.html">
   Abstract
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../methods.html">
   Methods
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../results.html">
   Results
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="chymotrypsin_inhibition.html">
     <strong>
      Scenario A:
     </strong>
     <br/>
     Chymotrypsin inhibiton by an
     <em>
      in silico
     </em>
     designed albumin fusion protein
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="glycosidase_inhibition.html">
     <strong>
      Scenario B:
     </strong>
     <br/>
     α-glucosidase inhibition by fucoidan
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     <strong>
      Scenario C:
     </strong>
     <br/>
     SLAC characterization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="enzyme_inactivation.html">
     <strong>
      Scenario D:
     </strong>
     <br/>
     Time-dependent enzyme inactivation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../discussion.html">
   Discussion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../conclusion.html">
   Conclusion and Outlook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/haeussma/masterthesis/master?urlpath=tree/book/scenarios/SLAC_kinetic_characterization.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/haeussma/masterthesis"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/scenarios/SLAC_kinetic_characterization.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#project-background">
   Project background
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#experimental-design">
     Experimental design
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-management">
     Data management
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-preparation">
   Data preparation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imports">
     Imports
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#experimental-data">
     Experimental data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#concentration-calculation">
     Concentration calculation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quality-control-through-mass-balance-analysis">
   Quality control through mass balance analysis
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kinetic-parameter-estimation">
   Kinetic parameter estimation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#choice-of-kinetic-model">
     Choice of kinetic model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parameter-estimates-for-k-cat-and-k-m">
     Parameter estimates for
     <span class="math notranslate nohighlight">
      \(k_{cat}\)
     </span>
     and
     <span class="math notranslate nohighlight">
      \(K_{m}\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#time-dependent-enzyme-inactivation">
     Time-dependent enzyme inactivation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#project-discussion">
   Project discussion
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     Data management
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correlation-between-parameters">
     Correlation between parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#enzyme-inactivation">
     Enzyme inactivation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#save-modeling-results">
   Save modeling results
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Scenario C:<br>SLAC characterization</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#project-background">
   Project background
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#experimental-design">
     Experimental design
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-management">
     Data management
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-preparation">
   Data preparation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imports">
     Imports
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#experimental-data">
     Experimental data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#concentration-calculation">
     Concentration calculation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quality-control-through-mass-balance-analysis">
   Quality control through mass balance analysis
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kinetic-parameter-estimation">
   Kinetic parameter estimation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#choice-of-kinetic-model">
     Choice of kinetic model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parameter-estimates-for-k-cat-and-k-m">
     Parameter estimates for
     <span class="math notranslate nohighlight">
      \(k_{cat}\)
     </span>
     and
     <span class="math notranslate nohighlight">
      \(K_{m}\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#time-dependent-enzyme-inactivation">
     Time-dependent enzyme inactivation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#project-discussion">
   Project discussion
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     Data management
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correlation-between-parameters">
     Correlation between parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#enzyme-inactivation">
     Enzyme inactivation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#save-modeling-results">
   Save modeling results
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="scenario-c-br-slac-characterization">
<h1><strong>Scenario C:</strong><br>SLAC characterization<a class="headerlink" href="#scenario-c-br-slac-characterization" title="Permalink to this headline">#</a></h1>
<p>Data provided by Alaric Prins (Applied Microbial and Health Biotechnology Institute, Cape Peninsula University of Technology, Capetown, South Africa)</p>
<section id="project-background">
<h2>Project background<a class="headerlink" href="#project-background" title="Permalink to this headline">#</a></h2>
<p>The small laccase from <em>Streptomyces coelicolor</em> (SLAC) is a member of the muticopper oxidase family. Due to their potential to oxidize various electron-rich substrates, laccases are of interest for industrial application for lignin degradation <span id="id1">(<a class="reference internal" href="../references.html#id13" title="Petri Widsten and Andreas Kandelbauer. Laccase applications in the forest products industry: a review. Enzyme and microbial technology, 42(4):293–307, 2008.">Widsten and Kandelbauer, 2008</a>)</span>. SLAC is currently used in ongoing biocatalysis and synergy projects. Recently, the wild-type SLAC was synthesised (previously cloned by restriction cloning) and codon-optimized for expression in <em>E. coli</em>. Therefore, the catalytic properties of the codon-optimized SLAC were investigated in a broad pH and temperature range, for rapid and accurate determination of biochemical data, which is useful for downstream applications.</p>
<section id="experimental-design">
<h3>Experimental design<a class="headerlink" href="#experimental-design" title="Permalink to this headline">#</a></h3>
<p>In this scenario the enzymatic oxidation of 2,2’-Azino-bis(3-ethylbenzothiazoline-6-sulfonic acid) (ABTS) to its radical form ABTS<sup>+·</sup> was studied in the pH range of pH 3 - pH 5.5 and temperature range of 25°C - 45°C. In total 30 kinetic enzyme assays in a substrate range between 0 - 200 µM of ABTS were conducted. Additionally, for each enzyme reaction with a given initial substrate concentration, a control reaction without enzyme was prepared.<br />
For each pH - temperature condition an individual ABTS standard curve and absorption spectrum was recorded to account for varying ABTS absorption properties due to reaction conditions. Each enzyme reaction was followed photometrically at two wavelengths for 15 min, measuring substrate depletion and product accumulation simultaneously. Preliminary experiments confirmed, that ABTS absorbs at 340 nm, whereas the ABTS<sup>+·</sup> absorbs at 420 nm, in contrast to the substrate. Furthermore, cross absorbance of product at the substrate detection wavelength and vice versa was ruled out.</p>
</section>
<section id="data-management">
<h3>Data management<a class="headerlink" href="#data-management" title="Permalink to this headline">#</a></h3>
<p>Overall, the dataset consists of more than 100 000 individual absorbance reads. Thus, data preparation was automated by custom parser functions, which were tailored to the output of the used spectrophotometer. Information on the involved reactants, and the enzyme was filled in an EnzymeML Excel spreadsheet, which served as a meta data container. All other information was parsed from the output of the spectrophotometer. Fig. 7 illustrates the schematic data flow of this project.</p>
<p><img alt="Fig. 7" src="../_images/workflow_SLAC.png" />
<em>Fig. 7: Schematic data pipeline of the SLAC project.</em></p>
</section>
</section>
<section id="data-preparation">
<h2>Data preparation<a class="headerlink" href="#data-preparation" title="Permalink to this headline">#</a></h2>
<section id="imports">
<h3>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span>
<span class="kn">import</span> <span class="nn">pyenzyme</span> <span class="k">as</span> <span class="nn">pe</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">from</span> <span class="nn">lmfit</span> <span class="kn">import</span> <span class="n">Parameters</span><span class="p">,</span> <span class="n">minimize</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">linregress</span><span class="p">,</span> <span class="n">pearsonr</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">Parallel</span><span class="p">,</span> <span class="n">delayed</span>
<span class="kn">from</span> <span class="nn">CaliPytion.tools.standardcurve</span> <span class="kn">import</span> <span class="n">StandardCurve</span>
<span class="kn">from</span> <span class="nn">EnzymePynetics.tools.parameterestimator</span> <span class="kn">import</span> <span class="n">ParameterEstimator</span>

<span class="c1"># Custom functions for data mapping</span>
<span class="kn">from</span> <span class="nn">parser_functions</span> <span class="kn">import</span> <span class="n">measurement_data_to_EnzymeML</span><span class="p">,</span> <span class="n">plot</span>
<span class="kn">from</span> <span class="nn">parser_functions</span> <span class="kn">import</span> <span class="n">read_measurement_data</span><span class="p">,</span> <span class="n">read_calibration_data</span>
<span class="kn">from</span> <span class="nn">parser_functions</span> <span class="kn">import</span> <span class="n">add_enzyme_inactivation_model</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="experimental-data">
<h3>Experimental data<a class="headerlink" href="#experimental-data" title="Permalink to this headline">#</a></h3>
<p>Data from SLAC reactions was loaded from the output files of the photometer and written to individual EnzymeML documents. Then, information of the control reactions was used to subtract the absorption contribution from enzyme and buffer from the substrate and product signal.</p>
<div class="cell tag_hide_cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify the location of the data sets</span>
<span class="n">directory_measurement_data</span> <span class="o">=</span> <span class="s2">&quot;../../data/SLAC_kinetic_characterization/TimeCourseData&quot;</span>
<span class="n">directory_standard_data</span> <span class="o">=</span> <span class="s2">&quot;../../data/SLAC_kinetic_characterization/StandardData&quot;</span>
<span class="n">directory_spectrum_data</span> <span class="o">=</span> <span class="s2">&quot;../../data/SLAC_kinetic_characterization/SpectrumData&quot;</span>
<span class="n">path_EnzymeML_templates</span> <span class="o">=</span> <span class="s2">&quot;../../data/SLAC_kinetic_characterization/EnzymeML_templates&quot;</span>

<span class="c1"># Define IDs for species, listed in the EnzymeML Excel template</span>
<span class="n">substrate_id</span> <span class="o">=</span> <span class="s2">&quot;s0&quot;</span>
<span class="n">product_id</span> <span class="o">=</span> <span class="s2">&quot;s1&quot;</span>
<span class="n">substrate_control_id</span> <span class="o">=</span> <span class="s2">&quot;s2&quot;</span>
<span class="n">product_control_id</span> <span class="o">=</span> <span class="s2">&quot;s3&quot;</span>
<span class="n">species_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">substrate_id</span><span class="p">,</span> <span class="n">product_id</span><span class="p">,</span> <span class="n">substrate_control_id</span><span class="p">,</span> <span class="n">product_control_id</span><span class="p">]</span>


<span class="c1"># Parse measurement data from photometer output</span>
<span class="n">raw_data_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory_measurement_data</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">read_measurement_data</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">directory_measurement_data</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">pH</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;pH&quot;</span><span class="p">]</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">]</span>
    <span class="n">raw_data_dict</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pH</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>

<span class="n">EnzymeML_template_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mf">3.0</span><span class="p">:</span> <span class="s2">&quot;EnzymeML_SLAC_pH3.xlsm&quot;</span><span class="p">,</span>
    <span class="mf">3.5</span><span class="p">:</span> <span class="s2">&quot;EnzymeML_SLAC_pH3_5.xlsm&quot;</span><span class="p">,</span>
    <span class="mf">4.0</span><span class="p">:</span> <span class="s2">&quot;EnzymeML_SLAC_pH4.xlsm&quot;</span><span class="p">,</span>
    <span class="mf">4.5</span><span class="p">:</span> <span class="s2">&quot;EnzymeML_SLAC_pH4_5.xlsm&quot;</span><span class="p">,</span>
    <span class="mf">5.0</span><span class="p">:</span> <span class="s2">&quot;EnzymeML_SLAC_pH5.xlsm&quot;</span><span class="p">,</span>
    <span class="mf">5.5</span><span class="p">:</span> <span class="s2">&quot;EnzymeML_SLAC_pH5_5.xlsm&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Write absorption data to EnzymeMLDocuments</span>
<span class="n">absortion_enzymemldocs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pe</span><span class="o">.</span><span class="n">EnzymeMLDocument</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">raw_data_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">pH</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;pH&quot;</span><span class="p">]</span>
    <span class="n">absortion_enzymemldocs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">measurement_data_to_EnzymeML</span><span class="p">(</span>
        <span class="n">template_path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path_EnzymeML_templates</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">EnzymeML_template_dict</span><span class="p">[</span><span class="n">pH</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">measurement_data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">species_ids</span><span class="o">=</span><span class="n">species_ids</span><span class="p">,</span>
        <span class="n">data_unit</span><span class="o">=</span><span class="s2">&quot;umole / l&quot;</span><span class="p">,</span>
        <span class="n">time_unit</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">))</span>

<span class="c1"># Sort documents by ascending pH and temperature</span>
<span class="n">absortion_enzymemldocs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">absortion_enzymemldocs</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="s2">&quot;r0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ph</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="s2">&quot;r0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">temperature</span><span class="p">))</span>

<span class="c1"># Blanc measurement data</span>
<span class="k">for</span> <span class="n">enzmldoc</span> <span class="ow">in</span> <span class="n">absortion_enzymemldocs</span><span class="p">:</span>
    <span class="n">blanc_measurement</span> <span class="o">=</span> <span class="n">enzmldoc</span><span class="o">.</span><span class="n">measurement_dict</span><span class="p">[</span><span class="s2">&quot;m0&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">getReactant</span><span class="p">(</span><span class="s2">&quot;s0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replicates</span>
    <span class="n">blanc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">repeat</span><span class="o">.</span><span class="n">data</span> <span class="k">for</span> <span class="n">repeat</span> <span class="ow">in</span> <span class="n">blanc_measurement</span><span class="p">])</span>

    <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">measurement</span> <span class="ow">in</span> <span class="n">enzmldoc</span><span class="o">.</span><span class="n">measurement_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">rep</span><span class="p">,</span> <span class="n">replicate</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">measurement</span><span class="o">.</span><span class="n">getReactant</span><span class="p">(</span><span class="s2">&quot;s0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replicates</span><span class="p">):</span>
            <span class="n">blanced_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="o">-</span> <span class="n">blanc</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">replicate</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
            <span class="n">enzmldoc</span><span class="o">.</span><span class="n">measurement_dict</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">getReactant</span><span class="p">(</span><span class="s2">&quot;s0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replicates</span><span class="p">[</span><span class="n">rep</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">blanced_data</span>
        <span class="k">for</span> <span class="n">rep</span><span class="p">,</span> <span class="n">replicate</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">measurement</span><span class="o">.</span><span class="n">getReactant</span><span class="p">(</span><span class="s2">&quot;s2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replicates</span><span class="p">):</span>
            <span class="n">blanced_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="o">-</span> <span class="n">blanc</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">replicate</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
            <span class="n">enzmldoc</span><span class="o">.</span><span class="n">measurement_dict</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">getReactant</span><span class="p">(</span><span class="s2">&quot;s2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replicates</span><span class="p">[</span><span class="n">rep</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">blanced_data</span>

        <span class="k">for</span> <span class="n">rep</span><span class="p">,</span> <span class="n">replicate</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">measurement</span><span class="o">.</span><span class="n">getReactant</span><span class="p">(</span><span class="s2">&quot;s1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replicates</span><span class="p">):</span>
            <span class="n">blanced_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="o">-</span> <span class="n">blanc</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">replicate</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
            <span class="n">enzmldoc</span><span class="o">.</span><span class="n">measurement_dict</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">getReactant</span><span class="p">(</span><span class="s2">&quot;s1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replicates</span><span class="p">[</span><span class="n">rep</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">blanced_data</span>
        <span class="k">for</span> <span class="n">rep</span><span class="p">,</span> <span class="n">replicate</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">measurement</span><span class="o">.</span><span class="n">getReactant</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replicates</span><span class="p">):</span>
            <span class="n">blanced_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="o">-</span> <span class="n">blanc</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">replicate</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
            <span class="n">enzmldoc</span><span class="o">.</span><span class="n">measurement_dict</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">getReactant</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replicates</span><span class="p">[</span><span class="n">rep</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">blanced_data</span>
    
    <span class="c1"># Delete control measurement &#39;m0&#39;</span>
    <span class="k">del</span> <span class="n">enzmldoc</span><span class="o">.</span><span class="n">measurement_dict</span><span class="p">[</span><span class="s2">&quot;m0&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="concentration-calculation">
<h3>Concentration calculation<a class="headerlink" href="#concentration-calculation" title="Permalink to this headline">#</a></h3>
<p>Calibration data was loaded and converted into individual instances of the calibration data model. Some meta data of the calibration needed to be provided to the custom <code class="docutils literal notranslate"><span class="pre">read_calibration_data</span></code> function, since the output of the used spectrophotometer only contained a minimum of information. Thereafter, a standard curve was created for each calibration data set. Thereby, only absorption values below 3.2 were considered, since higher absorption values could not be converted into concentration accurately due to the detection limit of the photometer.
Lastly, the fit of each standard curves was visualized.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load calibration raw data</span>
<span class="n">calibration_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">standard_directory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory_standard_data</span><span class="p">))</span>
<span class="n">spectrum_directory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory_spectrum_data</span><span class="p">))</span>

<span class="k">for</span> <span class="n">standard</span><span class="p">,</span> <span class="n">spectrum</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">standard_directory</span><span class="p">,</span> <span class="n">spectrum_directory</span><span class="p">):</span>
    <span class="n">standard</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">directory_standard_data</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">standard</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">spectrum</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">directory_spectrum_data</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">spectrum</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">read_calibration_data</span><span class="p">(</span>
        <span class="n">path_standard</span><span class="o">=</span><span class="n">standard</span><span class="p">,</span>
        <span class="n">path_spectrum</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span>
        <span class="n">species_id</span><span class="o">=</span><span class="n">substrate_id</span><span class="p">,</span>
        <span class="n">wavelengths</span><span class="o">=</span><span class="p">[</span><span class="mi">340</span><span class="p">,</span> <span class="mi">420</span><span class="p">],</span>
        <span class="n">concentrations</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">125</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">175</span><span class="p">,</span><span class="mi">200</span><span class="p">],</span>
        <span class="n">concentration_unit</span><span class="o">=</span><span class="s2">&quot;umole / l&quot;</span><span class="p">,</span>
        <span class="n">device_manufacturer</span><span class="o">=</span><span class="s2">&quot;Molecular Devices&quot;</span><span class="p">,</span>
        <span class="n">device_model</span><span class="o">=</span><span class="s2">&quot;SpectraMax i3x&quot;</span><span class="p">,</span>
        <span class="n">spectrum_reactant_concentration</span><span class="o">=</span><span class="mi">100</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">pH</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">calibration_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">pH</span><span class="p">])</span>

<span class="c1"># Sort calibration data by ascending pH and temperature</span>
<span class="n">calibration_data</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">calibration_data</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">pH</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">temperature</span><span class="p">))</span>

<span class="c1"># Generate standard curves for ABTS calibration data</span>
<span class="n">standard_curves</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">StandardCurve</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">calibration</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">calibration_data</span><span class="p">):</span>
    <span class="n">standard_curves</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StandardCurve</span><span class="p">(</span><span class="n">calibration_data</span><span class="o">=</span><span class="n">calibration</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mi">340</span><span class="p">,</span> <span class="n">cutoff_absorption</span><span class="o">=</span><span class="mf">3.2</span><span class="p">,</span> <span class="n">show_output</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># Sort standard curves by ascending pH and temperature.</span>
<span class="n">standard_curves</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">standard_curves</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">calibration_data</span><span class="o">.</span><span class="n">pH</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">calibration_data</span><span class="o">.</span><span class="n">temperature</span><span class="p">))</span>

<span class="c1"># Visualize all fitted standard curves </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">standard</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">standard_curves</span><span class="p">[:</span><span class="mi">30</span><span class="p">],</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">())):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="o">%</span><span class="k">5</span>:
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;ABTS [uM]&quot;</span><span class="p">)</span>
    <span class="n">standard</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pH </span><span class="si">{</span><span class="n">standard</span><span class="o">.</span><span class="n">calibration_data</span><span class="o">.</span><span class="n">pH</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">standard</span><span class="o">.</span><span class="n">calibration_data</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s2">°C&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">29</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;time [s]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/SLAC_kinetic_characterization_6_0.png" src="../_images/SLAC_kinetic_characterization_6_0.png" />
</div>
</div>
<p><em>Fig. 8: ABTS standard curves for different experimental condition.</em></p>
<p>Since the absorption characteristics of ABTS change with pH, the calibration range differs between pH values, due to the upper absorption limit (Fig. 8). In consequence, the upper calibration limit for reactions at pH 3, pH 3.5, and pH 5.5 is at 150 µM of ABTS, whereas for all other pH values the upper limit is at 175 uM. This might source from the protonation state of ABTS, since the sulfonate groups of ABTS are deprotonated for less acidic pH values. Therefore, the absorption properties of ABTS might decrease. Calibration curve data at pH 5.5 showed larger variation between the repeats. In this case, pipetting of one of the three repeats differs from the other two, which should be considered for kinetic parameter estimation. In contrast to pH, the temperature during calibration affected the calibration curve only marginally.</p>
<p>The generated standard curves were used to convert the absorption measurement data into concentration data. Thereby, the respective concentration values were only calculated, if the measured absorption was within the respective calibration bounds to avoid extrapolation.</p>
<div class="cell tag_output_scroll tag_hide_cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate concentrations by applying standard curves to &#39;EnzymeMLDocuments&#39;.</span>
<span class="n">concentration_enzymemldocs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">standard_curve</span><span class="p">,</span> <span class="n">abso_enzmldoc</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">standard_curves</span><span class="p">,</span> <span class="n">absortion_enzymemldocs</span><span class="p">):</span>

    <span class="c1"># Validate, that measurement data is paired with respective standard curve</span>
    <span class="k">assert</span> <span class="n">standard_curve</span><span class="o">.</span><span class="n">calibration_data</span><span class="o">.</span><span class="n">pH</span> <span class="o">==</span> <span class="n">abso_enzmldoc</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="s2">&quot;r0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ph</span>
    <span class="k">assert</span> <span class="n">standard_curve</span><span class="o">.</span><span class="n">calibration_data</span><span class="o">.</span><span class="n">temperature</span> <span class="o">==</span> <span class="n">abso_enzmldoc</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="s2">&quot;r0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">temperature</span>

    <span class="n">enzmldoc</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">abso_enzmldoc</span><span class="p">)</span>
    <span class="n">conc_enzmldoc</span> <span class="o">=</span> <span class="n">standard_curve</span><span class="o">.</span><span class="n">apply_to_EnzymeML</span><span class="p">(</span><span class="n">enzmldoc</span><span class="p">,</span> <span class="s2">&quot;s0&quot;</span><span class="p">,</span> <span class="n">ommit_nan_measurements</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">conc_enzmldoc</span> <span class="o">=</span> <span class="n">standard_curve</span><span class="o">.</span><span class="n">apply_to_EnzymeML</span><span class="p">(</span><span class="n">enzmldoc</span><span class="p">,</span> <span class="s2">&quot;s2&quot;</span><span class="p">,</span> <span class="n">ommit_nan_measurements</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">concentration_enzymemldocs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conc_enzmldoc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m8&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m8&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m8&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m8&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m8&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
Measurements &#39;[&#39;m9&#39;]&#39; removed from document, since respective measurement values are out of calibration range.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="quality-control-through-mass-balance-analysis">
<h2>Quality control through mass balance analysis<a class="headerlink" href="#quality-control-through-mass-balance-analysis" title="Permalink to this headline">#</a></h2>
<p>Since product and substrate of the SLAC reaction were simultaneously recorded, mass balance analysis was conducted as a control of quality. By assuming mass conservation, the following concentration balance can be established:</p>
<div class="math notranslate nohighlight" id="equation-mass-balance">
<span class="eqno">(14)<a class="headerlink" href="#equation-mass-balance" title="Permalink to this equation">#</a></span>\[0 = S_{(t)} + P_{(t)} - S_{0}\]</div>
<p>Where, <span class="math notranslate nohighlight">\(S_{0}\)</span> denotes the initial substrate concentration, whereas <span class="math notranslate nohighlight">\(S_{(t)}\)</span> and <span class="math notranslate nohighlight">\(P_{(t)}\)</span> describe the substrate and product concentration for each time point <span class="math notranslate nohighlight">\(t\)</span>. Since <span class="math notranslate nohighlight">\(S_{t}\)</span> and <span class="math notranslate nohighlight">\(S_{0}\)</span> were individually measured, each enzyme reaction with a given initial substrate concentration had a control reaction with identical substrate concentration. In contrast to the substrate, no calibration standard was available for the product. Therefore, an additional parameter <span class="math notranslate nohighlight">\(k\)</span> was introduced to the mass balance equation, assuming linear relationship between the product concentration and its signal:</p>
<div class="math notranslate nohighlight" id="equation-mass-balance-with-k">
<span class="eqno">(15)<a class="headerlink" href="#equation-mass-balance-with-k" title="Permalink to this equation">#</a></span>\[0 = S_{(t)} + P_{(t)}k - S_{0}\]</div>
<p><span class="math notranslate nohighlight">\(k\)</span> was determined for each dataset individually by a minimization algorithm. The minimization objective was to find the optimal <span class="math notranslate nohighlight">\(k\)</span>, which minimizes all slopes of an experiment. If the slopes are zero, mass conservation is given over the observed time-course. Mass balances of all measurements are visualized in Fig. 9.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defenition of parameter &#39;k&#39;</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">()</span>
<span class="n">params</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

<span class="c1"># Target function for the minimizer</span>
<span class="k">def</span> <span class="nf">residual</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">k</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]</span>

    <span class="n">substrate</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span>  <span class="n">control</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">slopes</span> <span class="o">=</span> <span class="n">substrate</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">substrate</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">control</span><span class="p">)):</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">prod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">cont</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">model</span> <span class="o">=</span> <span class="n">sub</span> <span class="o">+</span> <span class="n">prod</span><span class="o">*</span><span class="n">k</span> <span class="o">-</span> <span class="n">cont</span>

        <span class="n">slopes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="p">)),</span> <span class="n">model</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">slopes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>


<span class="n">f</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">12.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">concentration_enzymemldocs</span><span class="p">,</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">())):</span>
    <span class="n">substrate</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">product</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">initial_substrate</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">control</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">measurement</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">measurement_dict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">initial_substrate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">measurement</span><span class="o">.</span><span class="n">getReactant</span><span class="p">(</span><span class="n">substrate_id</span><span class="p">)</span><span class="o">.</span><span class="n">init_conc</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">replicate</span> <span class="ow">in</span> <span class="n">measurement</span><span class="o">.</span><span class="n">getReactant</span><span class="p">(</span><span class="n">substrate_id</span><span class="p">)</span><span class="o">.</span><span class="n">replicates</span><span class="p">:</span>
            <span class="n">substrate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">replicate</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">replicate</span> <span class="ow">in</span> <span class="n">measurement</span><span class="o">.</span><span class="n">getReactant</span><span class="p">(</span><span class="n">product_id</span><span class="p">)</span><span class="o">.</span><span class="n">replicates</span><span class="p">:</span>
            <span class="n">product</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">replicate</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">replicate</span> <span class="ow">in</span> <span class="n">measurement</span><span class="o">.</span><span class="n">getReactant</span><span class="p">(</span><span class="s2">&quot;s2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replicates</span><span class="p">:</span>
            <span class="n">control</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">replicate</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">replicate</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>

    <span class="n">product</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">product</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">((</span><span class="n">product</span><span class="p">))</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">substrate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">substrate</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">((</span><span class="n">substrate</span><span class="p">))</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">control</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">control</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">((</span><span class="n">control</span><span class="p">))</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">initial_substrate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">initial_substrate</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">substrate</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">control</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">residual</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,))</span>

    <span class="n">factor</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
    <span class="n">f</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">substrate</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span>  <span class="n">control</span><span class="p">,</span> <span class="n">initial_substrate</span><span class="p">)):</span>
        <span class="n">init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">prod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">cont</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">balance</span> <span class="o">=</span> <span class="p">(</span><span class="n">sub</span> <span class="o">+</span> <span class="n">prod</span><span class="o">*</span><span class="n">factor</span> <span class="o">-</span> <span class="n">cont</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">getMeasurement</span><span class="p">(</span><span class="s2">&quot;m1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getReactant</span><span class="p">(</span><span class="s2">&quot;s0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replicates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">balance</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">l</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="o">%</span><span class="k">5</span>:
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;mass balance [uM]&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;time [s]&quot;</span><span class="p">)</span>
        <span class="n">pH</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="s2">&quot;r0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ph</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="s2">&quot;r0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">temperature</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pH </span><span class="si">{</span><span class="n">pH</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s2">°C&quot;</span><span class="p">)</span><span class="c1">#, factor: {factor:.0f}&quot;)</span>
    <span class="k">if</span> <span class="n">e</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower center&quot;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;initial ABTS [uM]&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.03</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/SLAC_kinetic_characterization_10_0.png" src="../_images/SLAC_kinetic_characterization_10_0.png" />
</div>
</div>
<p><em>Fig. 9: Quality control of each experiment through modeled mass balance.</em></p>
<p>For all experiments, except for pH 4, 45°C and pH 4.5, 35°C, the product and substrate is, qualitatively, in balance over the reaction time-course (Fig. 9). Mass balances, differing from 0 µM originate from differing substrate concentration in the enzyme reaction and the substrate control. In the reactions at pH 4, 45°C and pH 4.5, 35°C the mass balance slopes are not linear. This indicates issues with the measurement. Therefore, the respective measurements likely result in wrong parameter estimations.</p>
</section>
<section id="kinetic-parameter-estimation">
<h2>Kinetic parameter estimation<a class="headerlink" href="#kinetic-parameter-estimation" title="Permalink to this headline">#</a></h2>
<section id="choice-of-kinetic-model">
<h3>Choice of kinetic model<a class="headerlink" href="#choice-of-kinetic-model" title="Permalink to this headline">#</a></h3>
<p>Model selection is vital for parameter estimation. Thus, different settings for the parameter estimator were tested. Firstly, product inhibition models were excluded, since in some of the experiments the measured initial substrate concentration was higher than the specified one, which is used to calculate product concentrations. This resulted in calculated product concentrations with negative values.<br />
Secondly, substrate inhibition models were excluded, since the model was not able to describe the observed reaction kinetics. This was evident from a higher AIC as well as more than 100 % standard deviation on the estimated parameters.<br />
Lastly, the irreversible Michaelis-Menten model with and without time-dependent enzyme inactivation was compared, since enzyme inactivation was observed in previous experiments. Estimated parameters and the fitted models are shown for the experimental data at pH 3 and 25˚C under two scenarios - taking enzyme inactivation into consideration and, conversely, without enzyme inactivation (Fig. 10).</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> 
            <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Estimated parameters without time-dependent enzyme inactivation:&quot;</span><span class="p">)</span>
        <span class="n">kinetics</span> <span class="o">=</span> <span class="n">ParameterEstimator</span><span class="o">.</span><span class="n">from_EnzymeML</span><span class="p">(</span><span class="n">concentration_enzymemldocs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;s0&quot;</span><span class="p">,</span> <span class="s2">&quot;substrate&quot;</span><span class="p">)</span>
        <span class="n">kinetics</span><span class="o">.</span><span class="n">fit_models</span><span class="p">(</span><span class="n">only_irrev_MM</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">kinetics</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;without enzyme inactivation&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;ABTS [uM]&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Estimated parameters with time-dependent enzyme inactivation:&quot;</span><span class="p">)</span>
        <span class="n">kinetics</span> <span class="o">=</span> <span class="n">ParameterEstimator</span><span class="o">.</span><span class="n">from_EnzymeML</span><span class="p">(</span><span class="n">concentration_enzymemldocs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;s0&quot;</span><span class="p">,</span> <span class="s2">&quot;substrate&quot;</span><span class="p">)</span>
        <span class="n">kinetics</span><span class="o">.</span><span class="n">fit_models</span><span class="p">(</span><span class="n">enzyme_inactivation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">only_irrev_MM</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">kinetics</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;with enzyme inactivation&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;time [s]&quot;</span><span class="p">)</span>
<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower center&quot;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;initial ABTS [uM]&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.09</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estimated parameters without time-dependent enzyme inactivation:
Fitting data to:
 - irreversible Michaelis Menten model
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AIC</th>
      <th>Km [umole / l]</th>
      <th>kcat / Km [1/s * 1/umole / l]</th>
      <th>kcat [1/s]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>irreversible Michaelis Menten</th>
      <td>-162</td>
      <td>35.473 +/- 5.52%</td>
      <td>0.009 +/- 5.89%</td>
      <td>0.308 +/- 2.07%</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estimated parameters with time-dependent enzyme inactivation:
Fitting data to:
 - irreversible Michaelis Menten model
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AIC</th>
      <th>Km [umole / l]</th>
      <th>kcat / Km [1/s * 1/umole / l]</th>
      <th>kcat [1/s]</th>
      <th>ki time-dep enzyme-inactiv. [1/s]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>irreversible Michaelis Menten</th>
      <td>-476</td>
      <td>35.137 +/- 3.00%</td>
      <td>0.013 +/- 3.58%</td>
      <td>0.460 +/- 1.95%</td>
      <td>0.001 +/- 4.47%</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/SLAC_kinetic_characterization_13_4.png" src="../_images/SLAC_kinetic_characterization_13_4.png" />
</div>
</div>
<p><em>Fig. 10: Fitted irreversible Michaelis-Menten model to experimental data of SLAC reaction at pH 3 and 25°C with and without considering time-dependent enzyme inactivation.</em></p>
<p>The model with enzyme inactivation describes the data better (Fig. 10B). This is characterized through a lower AIC, as well as lower standard deviations on the estimated parameters.
In absolute terms, the estimated <span class="math notranslate nohighlight">\(K_{m}\)</span> of both models is approximately identical, whereas the <span class="math notranslate nohighlight">\(k_{cat}\)</span> estimate is approximately 33% lower for the model without enzyme inactivation. Hence, the model without enzyme inactivation underestimates the turnover number of the enzyme. As a result, irreversible Michaelis-Menten model with time-dependent enzyme inactivation was selected for the parameter estimation for all data sets.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run parameter estimator for all datasets, utilizing multi-processing.</span>
<span class="k">def</span> <span class="nf">run_ParameterEstimator</span><span class="p">(</span><span class="n">enzmldoc</span><span class="p">:</span> <span class="n">pe</span><span class="o">.</span><span class="n">EnzymeMLDocument</span><span class="p">):</span>    
    <span class="n">kinetics</span> <span class="o">=</span> <span class="n">ParameterEstimator</span><span class="o">.</span><span class="n">from_EnzymeML</span><span class="p">(</span><span class="n">enzmldoc</span><span class="p">,</span> <span class="s2">&quot;s0&quot;</span><span class="p">,</span> <span class="s2">&quot;substrate&quot;</span><span class="p">)</span>
    <span class="n">kinetics</span><span class="o">.</span><span class="n">fit_models</span><span class="p">(</span><span class="n">enzyme_inactivation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">only_irrev_MM</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">display_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kinetics</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">8</span><span class="p">)(</span><span class="n">delayed</span><span class="p">(</span><span class="n">run_ParameterEstimator</span><span class="p">)(</span><span class="n">enzmldoc</span><span class="p">)</span> <span class="k">for</span> <span class="n">enzmldoc</span> <span class="ow">in</span> <span class="n">concentration_enzymemldocs</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pH</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">temperature</span><span class="p">))</span>

<span class="c1"># Visualize all fitted models</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">12.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">())):</span>
    <span class="n">ph</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pH</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="o">%</span><span class="k">5</span>:
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;ABTS [uM]&quot;</span><span class="p">)</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;pH </span><span class="si">{</span><span class="n">doc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pH</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">doc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s2">°C&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">29</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;time [s]&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower center&quot;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;initial ABTS [uM]&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.04</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/SLAC_kinetic_characterization_15_0.png" src="../_images/SLAC_kinetic_characterization_15_0.png" />
</div>
</div>
<p><em>Fig. 11: Experimental data and fitted irreversible Michaelis-Menten model with time-dependent enzyme inactivation of SLAC reactions under various conditions.</em></p>
<p>Experimental data as well as the fitted model are visualized in Fig 11. Based on the reaction slopes, no catalytic activity was observed for reactions at pH 5 or higher.
As in the mass balance analysis, the reactions at pH 4, 45°C and pH 4.5, 35°C visually differed from other experiments with identical pH. In both cases, all applied substrate concentrations were higher than intended in the design of the experiment. Furthermore, the resulting parameter estimates have a high uncertainty. Therefore, the respective measurements were excluded from further analysis. Additionally, the results from pH 5.5, 35°C were excluded, since the uncertainty of the parameters could not be estimated. All calculated kinetic parameters are listed in the table below.</p>
<div class="cell tag_hide_cell tag_output_croll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract kinetic parameters of all datasets</span>
<span class="n">kcat</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">kcat_std</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">Km</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">Km_std</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ki</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ki_std</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">pH</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">corr_kcat_km</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_parameter_dict</span><span class="p">()</span>

    <span class="n">kcat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;k_cat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="n">kcat_std</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;k_cat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>

    <span class="n">Km</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;Km&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="n">Km_std</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;Km&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>

    <span class="n">ki</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;K_ie&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="n">ki_std</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;K_ie&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>  

    <span class="n">correlation</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;k_cat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">correl</span>
    <span class="k">if</span> <span class="n">correlation</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">corr_kcat_km</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">corr_kcat_km</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">correlation</span><span class="p">[</span><span class="s2">&quot;Km&quot;</span><span class="p">])</span>

    <span class="n">pH</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pH</span><span class="p">)</span>
    <span class="n">temperature</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># Organize kinetic and experimantal parameters in a &#39;DataFrame&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span>
    <span class="s1">&#39;pH&#39;</span><span class="p">:</span><span class="n">pH</span><span class="p">,</span> 
    <span class="s2">&quot;temperature [C]&quot;</span><span class="p">:</span><span class="n">temperature</span><span class="p">,</span> 
    <span class="s1">&#39;kcat [1/s]&#39;</span><span class="p">:</span><span class="n">kcat</span><span class="p">,</span> 
    <span class="s1">&#39;kcat stderr&#39;</span><span class="p">:</span><span class="n">kcat_std</span><span class="p">,</span> 
    <span class="s1">&#39;Km [uM]&#39;</span><span class="p">:</span><span class="n">Km</span><span class="p">,</span> 
    <span class="s1">&#39;Km stderr&#39;</span><span class="p">:</span><span class="n">Km_std</span><span class="p">,</span> 
    <span class="s2">&quot;Enzyme inactivation [1/s]&quot;</span><span class="p">:</span><span class="n">ki</span><span class="p">,</span>
    <span class="s2">&quot;Enzyme inactivation std&quot;</span><span class="p">:</span><span class="n">ki_std</span><span class="p">,</span>
    <span class="s2">&quot;correlation kcat/Km&quot;</span><span class="p">:</span><span class="n">corr_kcat_km</span><span class="p">})</span>

<span class="n">df</span><span class="p">[</span><span class="s2">&quot;kcat/Km [1/s * uM]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;kcat [1/s]&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Km [uM]&quot;</span><span class="p">]</span>
<span class="n">kcat_km_stderr</span> <span class="o">=</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;kcat stderr&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;kcat [1/s]&quot;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Km stderr&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Km [uM]&quot;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;kcat/Km [1/s * uM]&quot;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;kcat/Km stderr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kcat_km_stderr</span>

<span class="c1"># Exclued results from failed experiments</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span> <span class="c1"># reached parameter boundaries --&gt; inactive</span>
<span class="c1">#df = df.drop(index=12) #Km really high stddev</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span> <span class="c1">#kcat outlier, mass balance outlier</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span> <span class="c1">#kcat outlier, mass balance outlier</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;zeros&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>

<span class="c1"># Calculate halflife of enzyme</span>
<span class="k">def</span> <span class="nf">calulate_halflife</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">x</span>

<span class="n">df</span><span class="p">[</span><span class="s2">&quot;half life [min]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Enzyme inactivation [1/s]&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">calulate_halflife</span><span class="p">)</span><span class="o">/</span><span class="mi">60</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;half life std&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Enzyme inactivation std&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Enzyme inactivation [1/s]&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;half life [min]&quot;</span><span class="p">]</span>

<span class="c1"># Delete inactivation rates</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Enzyme inactivation [1/s]&quot;</span><span class="p">,</span> <span class="s2">&quot;Enzyme inactivation std&quot;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pH</th>
      <th>temperature [C]</th>
      <th>kcat [1/s]</th>
      <th>kcat stderr</th>
      <th>Km [uM]</th>
      <th>Km stderr</th>
      <th>correlation kcat/Km</th>
      <th>kcat/Km [1/s * uM]</th>
      <th>kcat/Km stderr</th>
      <th>zeros</th>
      <th>half life [min]</th>
      <th>half life std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
      <td>25.0</td>
      <td>0.459962</td>
      <td>0.008966</td>
      <td>35.137357</td>
      <td>1.053968</td>
      <td>0.535141</td>
      <td>0.013090</td>
      <td>0.000468</td>
      <td>0.0</td>
      <td>9.139562</td>
      <td>0.408568</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>30.0</td>
      <td>0.470366</td>
      <td>0.009855</td>
      <td>32.114083</td>
      <td>1.037088</td>
      <td>0.522963</td>
      <td>0.014647</td>
      <td>0.000564</td>
      <td>0.0</td>
      <td>9.522170</td>
      <td>0.476531</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.0</td>
      <td>35.0</td>
      <td>0.546029</td>
      <td>0.016598</td>
      <td>37.454496</td>
      <td>1.765891</td>
      <td>0.558865</td>
      <td>0.014578</td>
      <td>0.000818</td>
      <td>0.0</td>
      <td>10.304462</td>
      <td>0.776312</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>40.0</td>
      <td>0.712488</td>
      <td>0.021754</td>
      <td>46.441229</td>
      <td>2.155285</td>
      <td>0.608947</td>
      <td>0.015342</td>
      <td>0.000852</td>
      <td>0.0</td>
      <td>9.127765</td>
      <td>0.600883</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>45.0</td>
      <td>0.815724</td>
      <td>0.022451</td>
      <td>47.967746</td>
      <td>2.047138</td>
      <td>0.623270</td>
      <td>0.017006</td>
      <td>0.000864</td>
      <td>0.0</td>
      <td>9.087343</td>
      <td>0.530573</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3.5</td>
      <td>25.0</td>
      <td>0.420480</td>
      <td>0.045642</td>
      <td>89.752447</td>
      <td>13.848584</td>
      <td>0.746575</td>
      <td>0.004685</td>
      <td>0.000884</td>
      <td>0.0</td>
      <td>8.824513</td>
      <td>1.680327</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3.5</td>
      <td>30.0</td>
      <td>0.399649</td>
      <td>0.007455</td>
      <td>61.224383</td>
      <td>1.674235</td>
      <td>0.666682</td>
      <td>0.006528</td>
      <td>0.000216</td>
      <td>0.0</td>
      <td>14.545045</td>
      <td>0.804521</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3.5</td>
      <td>35.0</td>
      <td>0.246773</td>
      <td>0.009247</td>
      <td>28.237534</td>
      <td>1.572755</td>
      <td>0.554406</td>
      <td>0.008739</td>
      <td>0.000587</td>
      <td>0.0</td>
      <td>18.269277</td>
      <td>2.766875</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3.5</td>
      <td>40.0</td>
      <td>0.650031</td>
      <td>0.012397</td>
      <td>79.432405</td>
      <td>2.189303</td>
      <td>0.731830</td>
      <td>0.008183</td>
      <td>0.000274</td>
      <td>0.0</td>
      <td>11.026573</td>
      <td>0.453021</td>
    </tr>
    <tr>
      <th>9</th>
      <td>3.5</td>
      <td>45.0</td>
      <td>0.978983</td>
      <td>0.026556</td>
      <td>103.784356</td>
      <td>4.040850</td>
      <td>0.774126</td>
      <td>0.009433</td>
      <td>0.000448</td>
      <td>0.0</td>
      <td>9.110325</td>
      <td>0.425387</td>
    </tr>
    <tr>
      <th>10</th>
      <td>4.0</td>
      <td>25.0</td>
      <td>0.115133</td>
      <td>0.008752</td>
      <td>65.852866</td>
      <td>2.476592</td>
      <td>0.247717</td>
      <td>0.001748</td>
      <td>0.000148</td>
      <td>0.0</td>
      <td>111.702355</td>
      <td>222.064200</td>
    </tr>
    <tr>
      <th>11</th>
      <td>4.0</td>
      <td>30.0</td>
      <td>0.192374</td>
      <td>0.020265</td>
      <td>95.314777</td>
      <td>5.569713</td>
      <td>-0.718208</td>
      <td>0.002018</td>
      <td>0.000243</td>
      <td>0.0</td>
      <td>23.819987</td>
      <td>10.874634</td>
    </tr>
    <tr>
      <th>12</th>
      <td>4.0</td>
      <td>35.0</td>
      <td>0.282991</td>
      <td>0.029279</td>
      <td>100.647793</td>
      <td>11.576143</td>
      <td>0.608286</td>
      <td>0.002812</td>
      <td>0.000435</td>
      <td>0.0</td>
      <td>14.929497</td>
      <td>4.974473</td>
    </tr>
    <tr>
      <th>13</th>
      <td>4.0</td>
      <td>40.0</td>
      <td>0.225429</td>
      <td>0.012766</td>
      <td>97.966631</td>
      <td>1.677116</td>
      <td>0.168743</td>
      <td>0.002301</td>
      <td>0.000136</td>
      <td>0.0</td>
      <td>29.441552</td>
      <td>12.288914</td>
    </tr>
    <tr>
      <th>15</th>
      <td>4.5</td>
      <td>25.0</td>
      <td>0.368730</td>
      <td>0.025801</td>
      <td>110.902372</td>
      <td>0.830267</td>
      <td>-0.736267</td>
      <td>0.003325</td>
      <td>0.000234</td>
      <td>0.0</td>
      <td>22.536023</td>
      <td>6.247470</td>
    </tr>
    <tr>
      <th>16</th>
      <td>4.5</td>
      <td>30.0</td>
      <td>0.486402</td>
      <td>0.036084</td>
      <td>148.193267</td>
      <td>3.440830</td>
      <td>0.816213</td>
      <td>0.003282</td>
      <td>0.000255</td>
      <td>0.0</td>
      <td>19.046651</td>
      <td>4.109261</td>
    </tr>
    <tr>
      <th>18</th>
      <td>4.5</td>
      <td>40.0</td>
      <td>0.549232</td>
      <td>0.021351</td>
      <td>178.481651</td>
      <td>2.544896</td>
      <td>0.084106</td>
      <td>0.003077</td>
      <td>0.000127</td>
      <td>0.0</td>
      <td>34.946634</td>
      <td>11.931005</td>
    </tr>
    <tr>
      <th>19</th>
      <td>4.5</td>
      <td>45.0</td>
      <td>0.235716</td>
      <td>0.013338</td>
      <td>64.718239</td>
      <td>0.037679</td>
      <td>-0.113239</td>
      <td>0.003642</td>
      <td>0.000206</td>
      <td>0.0</td>
      <td>108.053681</td>
      <td>160.970528</td>
    </tr>
    <tr>
      <th>20</th>
      <td>5.0</td>
      <td>25.0</td>
      <td>0.008085</td>
      <td>0.006871</td>
      <td>15.067578</td>
      <td>20.447918</td>
      <td>0.276523</td>
      <td>0.000537</td>
      <td>0.000859</td>
      <td>0.0</td>
      <td>115.522134</td>
      <td>2593.086797</td>
    </tr>
    <tr>
      <th>21</th>
      <td>5.0</td>
      <td>30.0</td>
      <td>0.040665</td>
      <td>0.005659</td>
      <td>50.772187</td>
      <td>3.784251</td>
      <td>0.009319</td>
      <td>0.000801</td>
      <td>0.000126</td>
      <td>0.0</td>
      <td>115.512956</td>
      <td>453.016208</td>
    </tr>
    <tr>
      <th>22</th>
      <td>5.0</td>
      <td>35.0</td>
      <td>0.061677</td>
      <td>0.006158</td>
      <td>68.874565</td>
      <td>0.267258</td>
      <td>0.299400</td>
      <td>0.000895</td>
      <td>0.000089</td>
      <td>0.0</td>
      <td>115.519891</td>
      <td>286.705892</td>
    </tr>
    <tr>
      <th>23</th>
      <td>5.0</td>
      <td>40.0</td>
      <td>0.131196</td>
      <td>0.017131</td>
      <td>91.314407</td>
      <td>2.756719</td>
      <td>-0.426692</td>
      <td>0.001437</td>
      <td>0.000193</td>
      <td>0.0</td>
      <td>8.399863</td>
      <td>2.519856</td>
    </tr>
    <tr>
      <th>24</th>
      <td>5.0</td>
      <td>45.0</td>
      <td>0.129399</td>
      <td>0.014577</td>
      <td>96.735544</td>
      <td>2.562607</td>
      <td>-0.696719</td>
      <td>0.001338</td>
      <td>0.000155</td>
      <td>0.0</td>
      <td>11.438272</td>
      <td>2.986966</td>
    </tr>
    <tr>
      <th>26</th>
      <td>5.5</td>
      <td>30.0</td>
      <td>0.014374</td>
      <td>0.007402</td>
      <td>96.125085</td>
      <td>0.393705</td>
      <td>-0.200038</td>
      <td>0.000150</td>
      <td>0.000077</td>
      <td>0.0</td>
      <td>115.523248</td>
      <td>1471.972292</td>
    </tr>
    <tr>
      <th>27</th>
      <td>5.5</td>
      <td>35.0</td>
      <td>0.124370</td>
      <td>0.023968</td>
      <td>81.996103</td>
      <td>22.257271</td>
      <td>0.771045</td>
      <td>0.001517</td>
      <td>0.000505</td>
      <td>0.0</td>
      <td>5.841192</td>
      <td>1.400781</td>
    </tr>
    <tr>
      <th>28</th>
      <td>5.5</td>
      <td>40.0</td>
      <td>0.055892</td>
      <td>0.016036</td>
      <td>48.740460</td>
      <td>19.833207</td>
      <td>0.552798</td>
      <td>0.001147</td>
      <td>0.000571</td>
      <td>0.0</td>
      <td>6.132460</td>
      <td>2.957303</td>
    </tr>
    <tr>
      <th>29</th>
      <td>5.5</td>
      <td>45.0</td>
      <td>0.075249</td>
      <td>0.015052</td>
      <td>115.390172</td>
      <td>27.541849</td>
      <td>0.604743</td>
      <td>0.000652</td>
      <td>0.000203</td>
      <td>0.0</td>
      <td>10.834329</td>
      <td>5.343971</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="parameter-estimates-for-k-cat-and-k-m">
<h3>Parameter estimates for <span class="math notranslate nohighlight">\(k_{cat}\)</span> and <span class="math notranslate nohighlight">\(K_{m}\)</span><a class="headerlink" href="#parameter-estimates-for-k-cat-and-k-m" title="Permalink to this headline">#</a></h3>
<p>The parameter estimates for <span class="math notranslate nohighlight">\(k_{cat}\)</span> and <span class="math notranslate nohighlight">\(K_{m}\)</span> showed correlation. For experiments at pH 3 and pH 3.5, the parameters were correlated between <em>r<sup>2</sup></em> = 0.5 - 0.85. This indicates, that the highest initial substrate concentration, which was applied for parameter estimation was not sufficiently high. Ideally, the highest initial substrate concentration applied for a kinetic experiment should be 10-fold higher than <span class="math notranslate nohighlight">\(K_{m}\)</span> to allow independent estimates for <span class="math notranslate nohighlight">\(k_{cat}\)</span> and <span class="math notranslate nohighlight">\(K_{m}\)</span> <span id="id2">(<a class="reference internal" href="../references.html#id11" title="Keith F Tipton, Richard N Armstrong, Barbara M Bakker, Amos Bairoch, Athel Cornish-Bowden, Peter J Halling, Jan-Hendrik Hofmeyr, Thomas S Leyh, Carsten Kettner, Frank M Raushel, and others. Standards for reporting enzyme data: the strenda consortium: what it aims to do and why it should be helpful. Perspectives in Science, 1(1-6):131–137, 2014.">Tipton <em>et al.</em>, 2014</a>)</span>. In this scenario, only reactions with an initial substrate concentration up to 175 µM were used for parameter estimation, due to the limited photometric detection range of ABTS. Hence, ABTS was only applied 1.5-fold to 6-fold of the estimated <span class="math notranslate nohighlight">\(K_{m}\)</span>.<br />
For reactions at pH 4 and above, positive as well as negative correlations were observed. This might result from wrong parameter estimates, due to minimal enzyme activity at the given reaction conditions.</p>
<p>Catalytic efficiency for all experimental conditions is visualized in Fig. 12B, whereas the pH is color-coded. For reactions with identical pH values, <span class="math notranslate nohighlight">\(k_{cat}\)</span> and <span class="math notranslate nohighlight">\(K_{m}\)</span> both increase with temperature. This might be attributed to the high correlation between the parameters. Thus, the individual change of <span class="math notranslate nohighlight">\(k_{cat}\)</span> or <span class="math notranslate nohighlight">\(K_{m}\)</span> through pH or temperature cannot be assessed with certainty. Therefore, the catalytic efficiency <span class="math notranslate nohighlight">\(\frac{k_{cat}}{K_{m}}\)</span>, was a better measure to assess the enzyme activity under different reaction conditions.</p>
<p>For reactions at pH 5 and above, almost no catalytic activity was observed. Hence, data of these experimental conditions is excluded from further analysis.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize estimated parameters</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">12.8</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> 
            <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="s2">&quot;Km [uM]&quot;</span><span class="p">,</span> <span class="n">ydata</span><span class="o">=</span><span class="s2">&quot;kcat [1/s]&quot;</span><span class="p">,</span> <span class="n">xerror</span><span class="o">=</span><span class="s2">&quot;Km stderr&quot;</span><span class="p">,</span> <span class="n">yerror</span><span class="o">=</span><span class="s2">&quot;kcat stderr&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;pH&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="s2">&quot;pH&quot;</span><span class="p">,</span> <span class="n">ydata</span><span class="o">=</span><span class="s2">&quot;kcat/Km [1/s * uM]&quot;</span><span class="p">,</span> <span class="n">xerror</span><span class="o">=</span><span class="s2">&quot;zeros&quot;</span><span class="p">,</span> <span class="n">yerror</span><span class="o">=</span><span class="s2">&quot;kcat/Km stderr&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;temperature [C]&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/SLAC_kinetic_characterization_19_0.png" src="../_images/SLAC_kinetic_characterization_19_0.png" />
</div>
</div>
<p><em>Fig. 12: A: Catalytic efficiency of SLAC under different pH and temperature conditions. B: Kinetic parameters <span class="math notranslate nohighlight">\(k_{cat}\)</span> and <span class="math notranslate nohighlight">\(K_{m}\)</span> estimates for SLAC reactions at different pH values.</em></p>
<p><span class="math notranslate nohighlight">\(\frac{k_{cat}}{K_{m}}\)</span> in relation to reaction pH is visualized in Fig. 12A. The highest catalytic efficiency was observed at pH 3 and 45°C. Increasing the pH by 0.5 reduced <span class="math notranslate nohighlight">\(\frac{k_{cat}}{K_{m}}\)</span> approximately by half. For higher pH values, <span class="math notranslate nohighlight">\(\frac{k_{cat}}{K_{m}}\)</span> is even further reduced. The catalytic efficiency is therefore highly sensitive to the pH. This might source from changes in the protonation state of either substrate or enzyme, hindering formation of the enzyme-substrate complex.
In terms of temperature, higher <span class="math notranslate nohighlight">\(\frac{k_{cat}}{K_{m}}\)</span> was achieved at higher temperatures. SLAC might even be more active above 45°C and under pH 3, since in previous studies SLAC was the most active at 95°C <span id="id3">(<a class="reference internal" href="../references.html#id30" title="Alaric Prins, L Kleinsmidt, Nuraan Khan, Bronwyn Kirby, Tukayi Kudanga, Jannik Vollmer, Juergen Pleiss, Stephanie Burton, and M Le Roes-Hill. The effect of mutations near the t1 copper site on the biochemical characteristics of the small laccase from streptomyces coelicolor a3 (2). Enzyme and microbial technology, 68:23–32, 2015.">Prins <em>et al.</em>, 2015</a>)</span>.</p>
</section>
<section id="time-dependent-enzyme-inactivation">
<h3>Time-dependent enzyme inactivation<a class="headerlink" href="#time-dependent-enzyme-inactivation" title="Permalink to this headline">#</a></h3>
<p>The half life of SLAC was calculated with equation <a class="reference internal" href="#equation-enzyme-halflife">(16)</a> <span id="id4">(<a class="reference internal" href="../references.html#id8" title="Engelbert Buxbaum. Enzyme Kinetics: Special Cases, pages 185–191. Springer International Publishing, Cham, 2015. URL: https://doi.org/10.1007/978-3-319-19920-7_8, doi:10.1007/978-3-319-19920-7_8.">Buxbaum, 2015</a>)</span>.</p>
<div class="math notranslate nohighlight" id="equation-enzyme-halflife">
<span class="eqno">(16)<a class="headerlink" href="#equation-enzyme-halflife" title="Permalink to this equation">#</a></span>\[t_{\frac{1}{2}} = \frac{ln(2)}{k_{inact}}\]</div>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exclued inactive enzyme reactions above pH 4.5 and discard measurements with more than 100 % standard deviation on enzyme inactivation parameter</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">19</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># more than 100 % standard deviation on enzyme inactivation parameter</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span> <span class="c1"># more than 100 % standard deviation on enzyme inactivation parameter</span>

<span class="c1"># Plot half life over catalytic efficiency</span>
<span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="s2">&quot;kcat/Km [1/s * uM]&quot;</span><span class="p">,</span> <span class="n">ydata</span><span class="o">=</span><span class="s2">&quot;half life [min]&quot;</span><span class="p">,</span> <span class="n">xerror</span><span class="o">=</span><span class="s2">&quot;kcat/Km stderr&quot;</span><span class="p">,</span> <span class="n">yerror</span><span class="o">=</span><span class="s2">&quot;half life std&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;pH&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/SLAC_kinetic_characterization_21_0.png" src="../_images/SLAC_kinetic_characterization_21_0.png" />
</div>
</div>
<p><em>Fig. 13: SLAC half-life in relation to catalytic efficiency</em></p>
<p>The enzyme’s calculated half life was between 8 - 18 min for reactions at pH 3 and pH 3.5, whereas enzyme reactions at higher pH values showed a half life between 15 - 35 min. Generally, reactions with higher catalytic efficiency showed a shorter half life compared to reactions with lower catalytic efficiency (Fig 13).
In order to check for corrections between <span class="math notranslate nohighlight">\(k_{inact}\)</span>, <span class="math notranslate nohighlight">\(k_{cat}\)</span>, <span class="math notranslate nohighlight">\(K_{m}\)</span>, <span class="math notranslate nohighlight">\(\frac{k_{cat}}{K_{m}}\)</span>, as well as the reaction temperature and pH, a correlation analysis was conducted across all datasets.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate correlations</span>
<span class="n">df_corr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;kcat stderr&quot;</span><span class="p">,</span> <span class="s2">&quot;Km stderr&quot;</span><span class="p">,</span> <span class="s2">&quot;correlation kcat/Km&quot;</span><span class="p">,</span> <span class="s2">&quot;kcat/Km stderr&quot;</span><span class="p">,</span> <span class="s2">&quot;zeros&quot;</span><span class="p">,</span> <span class="s2">&quot;half life std&quot;</span><span class="p">])</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">df_corr</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="c1"># Visualize correlation heatmap</span>
<span class="c1">#sns.heatmap(rho, </span>
<span class="c1">#        xticklabels=rho.columns,</span>
<span class="c1">#        yticklabels=rho.columns,</span>
<span class="c1">#        cmap = sns.color_palette(&quot;vlag&quot;, as_cmap=True))</span>
<span class="c1">#plt.show()</span>

<span class="c1"># Calculate confidence intercal for correlations</span>
<span class="n">pval</span> <span class="o">=</span> <span class="n">df_corr</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pearsonr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="o">*</span><span class="n">rho</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">pval</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;*&#39;</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">.05</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span><span class="o">&lt;=</span><span class="n">t</span><span class="p">]))</span>
<span class="n">rho</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pH</th>
      <th>temperature [C]</th>
      <th>kcat [1/s]</th>
      <th>Km [uM]</th>
      <th>kcat/Km [1/s * uM]</th>
      <th>half life [min]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pH</th>
      <td>1.0*</td>
      <td>-0.15</td>
      <td>-0.39</td>
      <td>0.88*</td>
      <td>-0.89*</td>
      <td>0.8*</td>
    </tr>
    <tr>
      <th>temperature [C]</th>
      <td>-0.15</td>
      <td>1.0*</td>
      <td>0.6*</td>
      <td>0.07</td>
      <td>0.27</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>kcat [1/s]</th>
      <td>-0.39</td>
      <td>0.6*</td>
      <td>1.0*</td>
      <td>-0.03</td>
      <td>0.58*</td>
      <td>-0.49</td>
    </tr>
    <tr>
      <th>Km [uM]</th>
      <td>0.88*</td>
      <td>0.07</td>
      <td>-0.03</td>
      <td>1.0*</td>
      <td>-0.75*</td>
      <td>0.68*</td>
    </tr>
    <tr>
      <th>kcat/Km [1/s * uM]</th>
      <td>-0.89*</td>
      <td>0.27</td>
      <td>0.58*</td>
      <td>-0.75*</td>
      <td>1.0*</td>
      <td>-0.71*</td>
    </tr>
    <tr>
      <th>half life [min]</th>
      <td>0.8*</td>
      <td>0.03</td>
      <td>-0.49</td>
      <td>0.68*</td>
      <td>-0.71*</td>
      <td>1.0*</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The above table shows correlation between kinetic parameters and experimental conditions. Thereby, significant (p &lt; 0.05) correlations are labeled with ‘*’. The half life of SLAC is significantly correlated to <span class="math notranslate nohighlight">\(\frac{k_{cat}}{K_{m}}\)</span> as well as to pH. Due to correlation between <span class="math notranslate nohighlight">\(k_{cat}\)</span> and <span class="math notranslate nohighlight">\(K_{m}\)</span>, the enzyme’s half life is also correlated to <span class="math notranslate nohighlight">\(K_{m}\)</span>. Multiple reasons are possible this observation. On the one hand, the observed correlation might be of technical origin. As such, the system of ordinary differential equations, describing the change in substrate and enzyme concentration, are not an accurate model for the reaction system. Therefore, high cross-correlation occurs, since individual observations cannot be attributed to individual parameters. On the other hand, enzyme activity and enzyme inactivation might be causally related. In this case, the formed ABTS radical might inactivate the enzyme by potential suicide inhibition, or the enzyme deteriorates through catalysis.</p>
</section>
</section>
<section id="project-discussion">
<h2>Project discussion<a class="headerlink" href="#project-discussion" title="Permalink to this headline">#</a></h2>
<section id="id5">
<h3>Data management<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h3>
<p>The established data pipeline allows scalable data preparation and analysis of enzyme kinetics experiments. In future experiments this workflow could be used to further expand the experimental parameter space. As a result, different enzymes with different substrates in different buffers at different temperatures and pH values could be analyzed.</p>
</section>
<section id="correlation-between-parameters">
<h3>Correlation between parameters<a class="headerlink" href="#correlation-between-parameters" title="Permalink to this headline">#</a></h3>
<p>The highest catalytic efficiency of SLAC was observed at pH 3 at 45°C and therefore on the edge of the investigated parameter space. Optimal reaction conditions might therefore be at an even lower pH and higher temperature. <span class="math notranslate nohighlight">\(k_{cat}\)</span> and <span class="math notranslate nohighlight">\(K_{m}\)</span> were correlated, which is likely the result of a too low initial substrate concentration in relation to the true <span class="math notranslate nohighlight">\(K_{m}\)</span> of the enzyme at a given experimental condition. Hence, in adjoining experiments the product signal could be used for parameter estimation, since the concentration to absorbance ratio is lower compared to the one of the product. However, a reliable method for product quantification would need to be established first.</p>
</section>
<section id="enzyme-inactivation">
<h3>Enzyme inactivation<a class="headerlink" href="#enzyme-inactivation" title="Permalink to this headline">#</a></h3>
<p>SLAC showed a short half life of approximately 10 min at reaction conditions with the highest catalytic efficiency, which was correlated to the catalytic efficiency. Further experiments are required to investigate the observed inactivation. This might be done by comparing the half life of SLAC with different substrates as well as higher enzyme concentrations. Enzyme inactivation is further discussed in the next chapter.</p>
</section>
</section>
<section id="save-modeling-results">
<h2>Save modeling results<a class="headerlink" href="#save-modeling-results" title="Permalink to this headline">#</a></h2>
<p>Lastly, the modeling results are written to the EnzymeML documents and the files are exported.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">result</span><span class="p">,</span> <span class="n">enzmldoc</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">concentration_enzymemldocs</span><span class="p">):</span>

    <span class="c1"># Write modeling results to kinetic parameters</span>
    <span class="n">k_cat</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">enzymeml</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">KineticParameter</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;k_cat&quot;</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">get_model_results</span><span class="p">()[</span><span class="s2">&quot;k_cat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
        <span class="n">unit</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;1 / </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">time_unit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">K_m</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">enzymeml</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">KineticParameter</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;K_m&quot;</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">get_model_results</span><span class="p">()[</span><span class="s2">&quot;Km&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
        <span class="n">unit</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_conc_unit</span><span class="p">)</span>

    <span class="c1"># Define kinetic model</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">KineticModel</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;irreversible Michaelis-Menten&quot;</span><span class="p">,</span>
        <span class="n">equation</span><span class="o">=</span><span class="s2">&quot;-k_cat * p0 * s0 / (K_m + s0)&quot;</span><span class="p">,</span>
        <span class="n">parameters</span><span class="o">=</span><span class="p">[</span><span class="n">k_cat</span><span class="p">,</span> <span class="n">K_m</span><span class="p">])</span>

    <span class="n">enzmldoc</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="s2">&quot;r0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>

    <span class="n">add_enzyme_inactivation_model</span><span class="p">(</span>
        <span class="n">result</span><span class="o">=</span><span class="n">result</span><span class="p">,</span>
        <span class="n">enzmldoc</span><span class="o">=</span><span class="n">enzmldoc</span><span class="p">)</span>
    


    <span class="c1"># Export EnzymeML documents</span>
    <span class="n">export</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">export</span><span class="p">:</span>
        <span class="n">enzmldoc</span><span class="o">.</span><span class="n">toFile</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./scenarios"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="glycosidase_inhibition.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><strong>Scenario B:</strong><br>α-glucosidase inhibition by fucoidan</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="enzyme_inactivation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Scenario D:</strong><br>Time-dependent enzyme inactivation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Max Häußler<br/>
  
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>